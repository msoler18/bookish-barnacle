(()=>{function d(){let n=document.querySelectorAll("[data-nutri-open]"),t=document.querySelector("[data-nutri-overlay]"),e=document.querySelector("[data-nutri-popup]"),s=document.querySelector("[data-nutri-close]");if(!n.length||!t||!e||!s)return;function i(){t.classList.remove("hidden"),e.classList.remove("hidden"),document.body.style.overflow="hidden"}function a(){t.classList.add("hidden"),e.classList.add("hidden"),document.body.style.overflow=""}n.forEach(r=>r.addEventListener("click",i)),t.addEventListener("click",a),s.addEventListener("click",a)}function u(){let n=document.querySelectorAll('a[href="#ravekit-product"]');n.length&&n.forEach(t=>{t.addEventListener("click",e=>{e.preventDefault();let s=document.getElementById("ravekit-product");s&&s.scrollIntoView({behavior:"smooth",block:"start"})})})}function y(n){let t=!1;return function(...e){t||(window.requestAnimationFrame(()=>{n(...e),t=!1}),t=!0)}}function h(){let n=Array.from(document.querySelectorAll("[data-parallax-speed]")).filter(i=>!i.classList.contains("alien_ravekit")).map(i=>({el:i,speed:parseFloat(i.dataset.parallaxSpeed)})),t=Array.from(document.querySelectorAll("[data-rotate-on-scroll]")).filter(i=>!i.classList.contains("alien_ravekit")).map(i=>({el:i,factor:parseFloat(i.dataset.rotateOnScroll)})),e=Array.from(document.querySelectorAll(".alien_ravekit")),s=()=>{let i=window.scrollY,a=window.innerHeight;n.forEach(({el:r,speed:o})=>{r.style.transform=`translateY(${i*o}px)`}),t.forEach(({el:r,factor:o})=>{let l=r.style.transform.replace(/rotate\([^)]+\)/,"");r.style.transform=`${l} rotate(${i*o}deg)`}),e.forEach(r=>{let o=r.getBoundingClientRect(),m=Math.min(Math.max((a-o.top)/(a+o.height),0),1)*180;r.style.transform=`rotate(${m}deg)`})};window.addEventListener("scroll",y(s)),s()}function p(){let n=document.querySelectorAll("[data-accordion-trigger]"),t=document.querySelectorAll("[data-accordion-content]");if(!n.length||!t.length){console.warn("No titles or contents found for science accordion.");return}n.forEach(e=>{e.addEventListener("click",s=>{let i=e.dataset.index;n.forEach(r=>r.classList.remove("is-active")),t.forEach(r=>r.classList.remove("is-active")),e.classList.add("is-active");let a=document.querySelector(`.science-accordion__item-content[data-content-index="${i}"]`);a?a.classList.add("is-active"):console.warn("No content found for index:",i)})})}function f(){let n=document.querySelector("[data-banner-text]"),t=document.querySelector(".free-shipping-banner__spacer");if(!n||!t)return;let e=n.offsetHeight;t.style.height=`${e}px`;let s=n.getBoundingClientRect().top+window.scrollY;function i(){window.scrollY>=s?n.classList.add("free-shipping-banner__text-container--sticky"):n.classList.remove("free-shipping-banner__text-container--sticky")}window.addEventListener("scroll",i),i()}var c=class{constructor(t){this.container=t;let e=document.getElementById("RavekitProductData");this.data=e?JSON.parse(e.textContent):{},this.settings=this.data.settings||{},this.variants=this.data.variants||[],this.variantBtns=t.querySelectorAll(".variant-button"),this.qtyDec=t.querySelector(".quantity-decrease"),this.qtyInc=t.querySelector(".quantity-increase"),this.qtyInput=t.querySelector(".quantity-input"),this.addBtn=t.querySelector(".add-to-cart"),this.btnSurface=this.addBtn.querySelector(".push-btn__surface .btn-price"),this.radioSingle=t.querySelector('input[value="single"]'),this.radioSub=t.querySelector('input[value="subscription"]'),this.singlePrice=t.querySelector(".single-price"),this.subsPrice=t.querySelector(".subs-price"),this.planSelect=t.querySelector("#selling_plan_select"),this.timerBlock=t.querySelector(".free-shipping-timer"),this.timerTextEl=t.querySelector(".timer-text"),this.timerCountEl=t.querySelector(".timer-countdown"),this.timerSuffix=t.querySelector(".timer-suffix"),this.selectedVariant=null,this.purchaseType="single",this.timerId=null,this.init()}init(){this.variantBtns.length&&(this.variantBtns[0].classList.add("selected"),this.onVariantChange(this.variantBtns[0].dataset.variantId)),this.bind(),this.updateButtonPrice()}bind(){this.variantBtns.forEach(t=>t.addEventListener("click",()=>{this.variantBtns.forEach(e=>e.classList.remove("selected")),t.classList.add("selected"),this.onVariantChange(t.dataset.variantId)})),this.qtyDec.addEventListener("click",()=>this.changeQty(-1)),this.qtyInc.addEventListener("click",()=>this.changeQty(1)),this.qtyInput.addEventListener("input",()=>this.updateButtonPrice()),[this.radioSingle,this.radioSub].forEach(t=>t.addEventListener("change",()=>{this.purchaseType=t.value,this.togglePlanSelect(),this.updateButtonPrice()})),this.planSelect.addEventListener("change",()=>{let t=this.planSelect.selectedOptions[0].text.split("\u2014").pop().trim();this.subsPrice.textContent=t,this.updateButtonPrice()}),this.addBtn.addEventListener("click",t=>{t.preventDefault(),this.addToCart()})}onVariantChange(t){this.selectedVariant=this.variants.find(e=>e.id.toString()===t),this.selectedVariant&&(this.singlePrice.textContent=this.selectedVariant.priceFormatted,this.renderPlans(),this.updateButtonPrice())}renderPlans(){this.planSelect.innerHTML="",this.selectedVariant.selling_plans.forEach(t=>{let e=document.createElement("option");e.value=t.price,e.dataset.planId=t.plan_id,e.textContent=`${t.name} \u2014 ${t.priceFormatted}`,this.planSelect.appendChild(e)}),this.subsPrice.textContent=this.selectedVariant.selling_plans[0].priceFormatted,this.radioSingle.checked=!0,this.purchaseType="single",this.togglePlanSelect()}togglePlanSelect(){this.planSelect.disabled=this.purchaseType!=="subscription"}changeQty(t){let e=parseInt(this.qtyInput.value,10)||1;e=Math.max(1,e+t),this.qtyInput.value=e,this.updateButtonPrice()}updateButtonPrice(){let e=(this.purchaseType==="single"?Number(this.selectedVariant.price):Number(this.planSelect.value))/100,s=Number(this.qtyInput.value)||1,i=e*s,a=i.toLocaleString("es-CO",{style:"currency",currency:"COP"});this.btnSurface.textContent=` ${a}`,this.setupTimer(i)}setupTimer(t){clearInterval(this.timerId);let e=Number(this.settings.freeShippingThreshold);if(t<e){this.timerBlock.style.display="flex",this.timerTextEl.textContent=this.settings.timerText,this.timerSuffix.textContent=this.settings.timerSuffix;let s=Date.now()+this.settings.timerDuration*6e4;this.runCountdown(s)}else this.timerBlock.style.display="none"}runCountdown(t){let e=()=>{let s=t-Date.now();if(s<=0){clearInterval(this.timerId),this.timerCountEl.textContent="00:00";return}let i=String(Math.floor(s/6e4)).padStart(2,"0"),a=String(Math.floor(s%6e4/1e3)).padStart(2,"0");this.timerCountEl.textContent=`${i}:${a}`};e(),this.timerId=setInterval(e,1e3)}addToCart(){if(!this.selectedVariant)return alert("Selecciona una variante.");let t={id:this.selectedVariant.id,quantity:Number(this.qtyInput.value)};this.purchaseType==="subscription"&&(t.selling_plan=this.planSelect.selectedOptions[0].dataset.planId),fetch("/cart/add.js",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(e=>e.ok?e.json():Promise.reject(e)).then(e=>console.log("[RavekitProduct] Cart response:",e)).catch(e=>console.error("[RavekitProduct] Cart error:",e))}};document.addEventListener("DOMContentLoaded",()=>{f(),h(),p(),document.querySelectorAll(".ravekit-product").forEach(n=>{new c(n)}),u(),d()});})();
