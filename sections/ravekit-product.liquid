{%- liquid
  assign product_handle = section.settings.product_handle
  assign product = all_products[product_handle]
-%}

<section class="ravekit-product">
  <div class="section-content text-center">
    {% if product %}
      <h2 class="ravekit-product__title mb-6">
        {{ product.title }}
      </h2>

      <div class="ravekit-product__price font-body text-xl mb-4">
        {% if product.variants.size > 0 %}
          {{ product.variants.first.price | money }}
        {% else %}
          {{ product.price | money }}
        {% endif %}
      </div>

      {% if product.description != blank %}
        <div class="ravekit-product__description max-w-2xl mx-auto mb-8 font-body leading-relaxed">
          {{ product.description }}
        </div>
      {% endif %}

      <div class="ravekit-product__features">
        {% for i in (1..3) %}
          {% assign feature_image_key = 'feature_image_' | append: i %}
          {% assign feature_text_key = 'feature_text_' | append: i %}
          {% assign icon = section.settings[feature_image_key] %}
          {% assign text = section.settings[feature_text_key] %}
          <div class="feature-item">
            {% if icon %}
              {% render 'render-image',
                img: icon,
                img_src: icon | image_url: width: 200,
                alt: text,
                width: "80",
                height: "80",
                size: "80"
              %}
            {% endif %}
            <p class="text-sm mt-2">{{ text }}</p>
          </div>
        {% endfor %}
      </div>

      {% if product.variants.size > 0 %}
        <div class="ravekit-product__variants flex justify-center gap-4 mb-8">
          {% for variant in product.variants %}
            <button
              type="button"
              class="variant-button border-2 border-white rounded-lg p-2 hover:bg-scheme-accent-1 transition"
              data-variant-id="{{ variant.id }}"
            >
              {% if variant.featured_image %}
                {% render 'render-image',
                  img: variant.featured_image,
                  img_src: variant.featured_image | image_url: width: 300,
                  alt: variant.title,
                  width: "80",
                  height: "80",
                  size: "80"
                %}
              {% else %}
                {{ variant.title }}
              {% endif %}
            </button>
          {% endfor %}
        </div>
      {% endif %}

      <div class="ravekit-product__cart gap-4">
        <span class="qty-title">
          Cantidad
        </span>
        <div class="quantity-selector flex items-center gap-2">
          <button type="button" class="quantity-decrease px-4 py-2 font-bold text-xl">-</button>
          <input type="number" class="quantity-input w-16 text-center border rounded" min="1" value="1">
          <button type="button" class="quantity-increase px-4 py-2 font-bold text-xl">+</button>
        </div>

        <button type="button" class="push-btn add-to-cart mt-4">
          <span class="push-btn__surface">Añadir al carrito</span>
        </button>
      </div>

    {% else %}
      <p class="text-center text-lg">Producto no encontrado.</p>
    {% endif %}
  </div>
</section>

{% schema %}
{
  "name": "Ravekit Product Section",
  "settings": [
    {
      "type": "text",
      "id": "product_handle",
      "label": "Handle o ID del producto",
      "default": "ravekit"
    },
    {
      "type": "image_picker",
      "id": "feature_image_1",
      "label": "Ícono 1"
    },
    {
      "type": "text",
      "id": "feature_text_1",
      "label": "Texto del ícono 1"
    },
    {
      "type": "image_picker",
      "id": "feature_image_2",
      "label": "Ícono 2"
    },
    {
      "type": "text",
      "id": "feature_text_2",
      "label": "Texto del ícono 2"
    },
    {
      "type": "image_picker",
      "id": "feature_image_3",
      "label": "Ícono 3"
    },
    {
      "type": "text",
      "id": "feature_text_3",
      "label": "Texto del ícono 3"
    }
  ],
  "presets": [
    {
      "name": "Ravekit Product Section"
    }
  ]
}
{% endschema %}
